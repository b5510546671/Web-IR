<?xml version="1.0"?>
<!doctype html public "-//w3c//dtd xhtml 1.0 strict//en"
"http://www.w3.org/tr/xhtml1/dtd/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>à¸à¸´à¸à¸ªà¸²à¸ªà¸¡à¸²à¸à¸´</title>
<style type="text/css">
body,html {
margin-top:0;
margin-left:0;
margin-right:0;
margin-bottom:0;
height: 100%;
width: 100%;
}
</style>
<!-- active content workaround support file -->
<script src="resources/javascript/ac_runactivecontent.js" type="text/javascript" ></script>
<script type="text/javascript">
<!--
function getqueryvariable(variable) {
  var query = window.location.search.substring(1);
  var vars = query.split("&");
  for (var i=0;i<vars.length;i++) {
    var pair = vars[i].split("=");
    if (pair[0] == variable) {
      return pair[1];
    }
  } 
  return -1;
}
// -->
</script>

<script type="text/javascript">
<!--
  var startimg = getqueryvariable("startimg");
  //alert(startimg);
// -->
</script> 

<!-- flash detection script block -->
<script type="text/javascript">
<!--
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// globals
// major version of flash required
var requiredmajorversion = 8;
// minor version of flash required
var requiredminorversion = 0;
// minor version of flash required
var requiredrevision = 0;
// the version of javascript supported
var jsversion = 1.0;
// - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
// -->
</script>
<script type="text/vbscript">
<!-- // visual basic helper required to detect flash player activex control version information
function vbgetswfver(i)
  on error resume next
  dim swcontrol, swversion
  swversion = 0
  
  set swcontrol = createobject("shockwaveflash.shockwaveflash." + cstr(i))
  if (isobject(swcontrol)) then
    swversion = swcontrol.getvariable("$version")
  end if
  vbgetswfver = swversion
end function
// -->
</script>
<script type="text/javascript">
<!-- // detect client browser type
var isie  = (navigator.appversion.indexof("msie") != -1) ? true : false;
var iswin = (navigator.appversion.tolowercase().indexof("win") != -1) ? true : false;
var isopera = (navigator.useragent.indexof("opera") != -1) ? true : false;
jsversion = 1.1;
// javascript helper required to detect flash player plugin version information
function jsgetswfver(i){
	// ns/opera version >= 3 check for flash plugin in plugin array
	if (navigator.plugins != null && navigator.plugins.length > 0) {
		if (navigator.plugins["shockwave flash 2.0"] || navigator.plugins["shockwave flash"]) {
			var swver2 = navigator.plugins["shockwave flash 2.0"] ? " 2.0" : "";
      		var flashdescription = navigator.plugins["shockwave flash" + swver2].description;
			descarray = flashdescription.split(" ");
			temparraymajor = descarray[2].split(".");
			versionmajor = temparraymajor[0];
			versionminor = temparraymajor[1];
			if ( descarray[3] != "" ) {
				temparrayminor = descarray[3].split("r");
			} else {
				temparrayminor = descarray[4].split("r");
			}
      		versionrevision = temparrayminor[1] > 0 ? temparrayminor[1] : 0;
            flashver = versionmajor + "." + versionminor + "." + versionrevision;
      	} else {
			flashver = -1;
		}
	}
	// msn/webtv 2.6 supports flash 4
	else if (navigator.useragent.tolowercase().indexof("webtv/2.6") != -1) flashver = 4;
	// webtv 2.5 supports flash 3
	else if (navigator.useragent.tolowercase().indexof("webtv/2.5") != -1) flashver = 3;
	// older webtv supports flash 2
	else if (navigator.useragent.tolowercase().indexof("webtv") != -1) flashver = 2;
	// can't detect in all other cases
	else {
		
		flashver = -1;
	}
	return flashver;
} 
// when called with reqmajorver, reqminorver, reqrevision returns true if that version or greater is available
function detectflashver(reqmajorver, reqminorver, reqrevision) 
{
 	reqver = parsefloat(reqmajorver + "." + reqrevision);
   	// loop backwards through the versions until we find the newest version	
	for (i=25;i>0;i = i - 1) {	
		if (isie && iswin && !isopera) {
			versionstr = vbgetswfver(i);
		} else {
			versionstr = jsgetswfver(i);		
		}
		if (versionstr == -1 ) { 
			return false;
		} else if (versionstr != 0) {
			if(isie && iswin && !isopera) {
				temparray         = versionstr.split(" ");
				tempstring        = temparray[1];
				versionarray      = tempstring .split(",");				
			} else {
				versionarray      = versionstr.split(".");
			}
			versionmajor      = versionarray[0];
			versionminor      = versionarray[1];
			versionrevision   = versionarray[2];
			
			versionstring     = versionmajor + "." + versionrevision;   // 7.0r24 == 7.24
			versionnum        = parsefloat(versionstring);
        	// is the major.revision >= requested major.revision and the minor version >= requested minor
			if ( (versionmajor > reqmajorver) && (versionnum >= reqver) ) {
				return true;
			} else {
				return ((versionnum >= reqver && versionminor >= reqminorver) ? true : false );	
			}
		}
	}	
}
// -->
</script>
</head>

<body>
<script type="text/javascript">
<!-- 
// version check for the flash player that has the ability to start player product install (6.0r65)
var hasproductinstall = detectflashver(6, 0, 65);

// version check based upon the values entered above in "globals"
var hasreqestedversion = detectflashver(requiredmajorversion, requiredminorversion, requiredrevision);

// location visited after installation is complete if installation is required
var mmredirecturl = window.location;

// stored value of document title used by the installation process to close the window that started the installation process
// this is necessary to remove browser windows that will still be utilizing the older version of the player after installation is complete
// do not modify the following two lines
//document.title = document.title.slice(0, 47) + " - flash player installation";
document.title = document.title.slice(0, 47);
var mmdoctitle = document.title;



// check to see if a player with flash product install is available and the version does not meet the requirements for playback
if ( hasproductinstall && !hasreqestedversion ) {
    var productinstalloetags = '<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"'
    + 'width="550" height="200"'
    + 'codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab">'
    + '<param name="movie" value="resources/playerproductinstall.swf?mmredirecturl='+mmredirecturl+'&mmplayertype=activex&mmdoctitle='+mmdoctitle+'" />'
    + '<param name="quality" value="best" /><param name="bgcolor" value="#3a6ea5" />'
    + '<embed src="resources/playerproductinstall.swf?mmredirecturl='+mmredirecturl+'&mmplayertype=plugin" quality="high" bgcolor="#3a6ea5" '
    + 'width="550" height="300" name="detectiontest" aligh="middle"'
    + 'play="true"'
    + 'loop="false"'
    + 'quality="best"'
    + 'allowscriptaccess="samedomain"'
    + 'type="application/x-shockwave-flash"'
    + 'pluginspage="http://www.adobe.com/go/getflashplayer">'
    + '<\/embed>'
    + '<\/object>';
    document.write(productinstalloetags);   // embed the flash product installation swf
} else if (hasreqestedversion) {  // if we've detected an acceptable version
    ac_fl_runcontent(
			'codebase', 'http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0',
			'flashvars','livepreview=false&baserefurl=&groupxml=resources/mediagroupdata/group.xml&stylexml=resources/styles/style.xml&localtext=resources/localization/localtext.xml&startimg='+startimg,
			'width', '100%',
			'height', '100%',
			'src', 'resources/gallery',
			'quality', 'high',
			'pluginspage', 'http://www.adobe.com/go/getflashplayer',
			'align', 'middle',
			'play', 'true',
			'loop', 'true',
			'scale', 'showall',
			'wmode', 'window',
			'devicefont', 'false',
			'id', 'gallery',
			'bgcolor', '#f7f7f7',
			'name', 'gallery',
			'menu', 'true',
			'allowscriptaccess','samedomain',
			'movie', 'resources/gallery',
			'salign', ''
			);
  } else {  // flash is too old or we can't detect the plugin
    var alternatecontent = 'this photo gallery requires the adobe flash player.'
   	+ '<a href=http://www.adobe.com/go/getflash/>get the free flash player here</a>';
    document.write(alternatecontent);  // insert non-flash content
  }
// -->
</script>
<noscript>
	<!-- provide alternate content for browsers that do not support scripting
	     or for those that have scripting disabled. -->
	<p>
  	sorry, this photo gallery requires that scripting be enabled on your web browser and that the adobe flash player be installed.
	<a href="http://www.adobe.com/go/getflash/">download the adobe flash player</a>
	</p>
</noscript>
</body>
</html>
